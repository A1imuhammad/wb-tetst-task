<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞</title>
  <link rel="stylesheet" href="styles/styles.css">
</head>
<body>
  <div class="container">
    <h1>–ü–æ–∏—Å–∫ –∑–∞–∫–∞–∑–∞ üîç</h1>
    <p>–í–≤–µ–¥–∏—Ç–µ <b>order_uid</b>, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ</p>
    <div>
      <input type="text" id="order_uid" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä: b563feb7b2b84b6test">
      <button onclick="fetchOrder()">–ù–∞–π—Ç–∏</button>
    </div>
    <div id="result" class="result"></div>
    <footer>–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å–µ—Ä–≤–∏—Å, 2025</footer>
  </div>

  <script>
    function formatOrderToHtml(data) {
      let html = '<p class="success">‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –Ω–∞–π–¥–µ–Ω!</p>';
      html += '<table class="order-table">';
      html += '<tr><th colspan="2">–û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–∫–∞–∑–∞</th></tr>';
      html += `<tr><td>Order UID</td><td>${data.order_uid}</td></tr>`;
      html += `<tr><td>Track Number</td><td>${data.track_number}</td></tr>`;
      html += `<tr><td>Entry</td><td>${data.entry}</td></tr>`;
      html += `<tr><td>Locale</td><td>${data.locale}</td></tr>`;
      html += `<tr><td>Customer ID</td><td>${data.customer_id}</td></tr>`;
      html += `<tr><td>Delivery Service</td><td>${data.delivery_service}</td></tr>`;
      html += `<tr><td>Shard Key</td><td>${data.shardkey}</td></tr>`;
      html += `<tr><td>SM ID</td><td>${data.sm_id}</td></tr>`;
      html += `<tr><td>Date Created</td><td>${new Date(data.date_created).toLocaleString()}</td></tr>`;
      html += `<tr><td>OOF Shard</td><td>${data.oof_shard}</td></tr>`;
      html += `<tr><td>Internal Signature</td><td>${data.internal_signature}</td></tr>`;

      html += '<tr><th colspan="2">–î–æ—Å—Ç–∞–≤–∫–∞</th></tr>';
      html += `<tr><td>Name</td><td>${data.delivery.name}</td></tr>`;
      html += `<tr><td>Phone</td><td>${data.delivery.phone}</td></tr>`;
      html += `<tr><td>ZIP</td><td>${data.delivery.zip}</td></tr>`;
      html += `<tr><td>City</td><td>${data.delivery.city}</td></tr>`;
      html += `<tr><td>Address</td><td>${data.delivery.address}</td></tr>`;
      html += `<tr><td>Region</td><td>${data.delivery.region}</td></tr>`;
      html += `<tr><td>Email</td><td>${data.delivery.email}</td></tr>`;

      html += '<tr><th colspan="2">–û–ø–ª–∞—Ç–∞</th></tr>';
      html += `<tr><td>Transaction</td><td>${data.payment.transaction}</td></tr>`;
      html += `<tr><td>Request ID</td><td>${data.payment.request_id}</td></tr>`;
      html += `<tr><td>Currency</td><td>${data.payment.currency}</td></tr>`;
      html += `<tr><td>Provider</td><td>${data.payment.provider}</td></tr>`;
      html += `<tr><td>Amount</td><td>${data.payment.amount}</td></tr>`;
      html += `<tr><td>Payment Date</td><td>${new Date(data.payment.payment_dt * 1000).toLocaleString()}</td></tr>`;
      html += `<tr><td>Bank</td><td>${data.payment.bank}</td></tr>`;
      html += `<tr><td>Delivery Cost</td><td>${data.payment.delivery_cost}</td></tr>`;
      html += `<tr><td>Goods Total</td><td>${data.payment.goods_total}</td></tr>`;
      html += `<tr><td>Custom Fee</td><td>${data.payment.custom_fee}</td></tr>`;

      html += '<tr><th colspan="2">–¢–æ–≤–∞—Ä—ã</th></tr>';
      data.items.forEach(item => {
        html += `<tr><td>${item.name}</td><td>CHRT ID: ${item.chrt_id}, Track Number: ${item.track_number}, Price: ${item.price}, RID: ${item.rid}, Sale: ${item.sale}, Size: ${item.size}, Total Price: ${item.total_price}, NM ID: ${item.nm_id}, Brand: ${item.brand}, Status: ${item.status}</td></tr>`;
      });

      html += '</table>';
      return html;
    }

    async function fetchOrder() {
      const orderId = document.getElementById('order_uid').value.trim();
      const resultDiv = document.getElementById('result');
      resultDiv.style.display = 'none';
      resultDiv.innerHTML = '';

      if (!orderId) {
        resultDiv.innerHTML = '<p class="error">‚ö† –í–≤–µ–¥–∏—Ç–µ ID –∑–∞–∫–∞–∑–∞</p>';
        resultDiv.classList.add('show');
        resultDiv.style.display = 'block';
        return;
      }

      try {
        const response = await fetch(`http://localhost:8085/order/${orderId}`);
        
        if (!response.ok) {
          resultDiv.innerHTML = '<p class="error">üö´ –ó–∞–∫–∞–∑ –Ω–µ –Ω–∞–π–¥–µ–Ω</p>';
        } else {
          const data = await response.json();
          resultDiv.innerHTML = formatOrderToHtml(data);
        }
      } catch (err) {
        resultDiv.innerHTML = '<p class="error">–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∏–ª–∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>';
      }

      resultDiv.classList.add('show');
      resultDiv.style.display = 'block';
    }
  </script>
</body>
</html>